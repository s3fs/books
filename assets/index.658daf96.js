var w=Object.defineProperty,x=Object.defineProperties;var T=Object.getOwnPropertyDescriptors;var O=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable;var I=(e,o,t)=>o in e?w(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,l=(e,o)=>{for(var t in o||(o={}))B.call(o,t)&&I(e,t,o[t]);if(O)for(var t of O(o))D.call(o,t)&&I(e,t,o[t]);return e},d=(e,o)=>x(e,T(o));import{a as G,u as j,b as q,c as H,j as c,d as n,R as M,e as R,f as F,L as p,g as P,h as $,i as K,B as Y,P as W}from"./vendor.7f9597da.js";const z=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}};z();const J=(e={books:[],query:null,index:0,loading:!1,category:"All",sort:"Relevance",booksAmount:0},o)=>{switch(o.type){case"SEARCH":return d(l({},e),{books:o.data,query:o.query,booksAmount:o.amount});case"LOAD_MORE_BOOKS":return d(l({},e),{books:[...e.books,...o.data],index:e.index+30});case"SET_LOADING_STATE":return d(l({},e),{loading:!e.loading});case"CHANGE_CATEGORY":return d(l({},e),{category:o.data});case"CHANGE_SORT":return d(l({},e),{sort:o.data});default:return e}},Q=(e,o,t)=>({type:"SEARCH",data:e,query:o,amount:t}),U=e=>({type:"LOAD_MORE_BOOKS",data:e}),V=e=>({type:"CHANGE_CATEGORY",data:e}),X=e=>({type:"CHANGE_SORT",data:e}),E=()=>({type:"SET_LOADING_STATE"}),L=async({data:e,index:o,category:t})=>{const r=`https://www.googleapis.com/books/v1/volumes?q=${e.split(" ").join("+")}${t!=="All"?`+subject:${t}`:""}&maxResults=30&startIndex=${o}`;return(await G.get(r)).data},Z=["All","Art","Biography","Computers","History","Medical","Poetry"],ee=["Relevance","Newest"],oe=({dispatch:e,state:o})=>{const t=F();return n("div",{children:c("form",{className:"search-form",onSubmit:async r=>{r.preventDefault();const s=r.target[0].value;if(!s)return;r.target[0].value="",t("/books"),e(E());const a=await L({data:s,index:o.index,category:o.category});e(Q(a.items,s,a.totalItems)),e(E())},children:[c("div",{className:"input-wrapper",children:[n("input",{className:"search-form_input",placeholder:"Enter a book name..."}),n("button",{type:"submit",className:"search-form_submit-button",children:"Search"})]}),c("div",{className:"search-form_selectors",children:[c("label",{htmlFor:"category-selector",children:["Category: "," ",n("select",{id:"category-selector",onChange:({target:r})=>e(V(r.value)),children:Z.map(r=>n("option",{children:r},r))})]}),c("label",{htmlFor:"sort-selector",children:["Sort by: "," ",n("select",{id:"sort-selector",onChange:({target:r})=>e(X(r.value)),children:ee.map(r=>n("option",{children:r},r))})]})]})]})})},re=({dispatch:e,state:o,books:t})=>{if(t===void 0)return n("h3",{className:"screen",children:"Hmm. No results for that."});if(t.length===0)return n("h3",{className:"screen",children:"Hi! Start searching the library by entering a title above."});const i=async()=>{const s=await L({data:o.query,index:o.index+30,category:o.category});e(U(s.items))},r=o.sort==="Relevance"?t:[...t].sort((s,a)=>{var u,m,h,g;return Number((m=(u=a.volumeInfo)==null?void 0:u.publishedDate)==null?void 0:m.substring(0,4))-Number((g=(h=s.volumeInfo)==null?void 0:h.publishedDate)==null?void 0:g.substring(0,4))});return c("div",{children:[c("h3",{className:"screen",children:["Found ",o.booksAmount,' books on "',o.query,'"']}),n("ul",{className:"book-card_container",children:r.map(s=>n(C,{book:s},s.id))}),n("div",{className:"pagination-button_container",children:n("button",{className:"pagination-button",onClick:i,children:"Load more..."})})]})},C=({book:e,page:o})=>{var t,i,r,s,a,u,m,h,g,f,b,v,y,N,_,k,A,S;return e==null?c("h3",{className:"screen",children:["No such book. ",n(p,{to:"/books",children:"Go to the main page."})]}):o?c("div",{children:[c("div",{className:"book-page_container",children:[n("img",{className:"book-page_image",src:(i=(t=e.volumeInfo)==null?void 0:t.imageLinks)==null?void 0:i.smallThumbnail}),c("div",{className:"book-page_contents",children:[n("span",{className:"book-page_contents__title",children:(r=e.volumeInfo)==null?void 0:r.title}),c("span",{className:"book-card_contents__categories",children:["Categories: ",((a=(s=e.volumeInfo)==null?void 0:s.categories)==null?void 0:a.join(", "))||"No categories listed"]}),c("span",{className:"book-card_contents__authors",children:["Authors: ",((m=(u=e.volumeInfo)==null?void 0:u.authors)==null?void 0:m.join(", "))||"Author unknown"]})]})]}),n("div",{className:"book-page_description",children:(h=e.volumeInfo)==null?void 0:h.description}),n("h3",{className:"screen",children:n(p,{to:"/books",children:"Go back"})})]}):n("li",{children:c(p,{className:"book-card",to:`/books/${e.id}`,children:[n("img",{className:"book-card_image",src:(f=(g=e.volumeInfo)==null?void 0:g.imageLinks)==null?void 0:f.smallThumbnail}),c("div",{className:"book-card_contents",children:[n("span",{className:"book-card_contents__title",children:((v=(b=e.volumeInfo)==null?void 0:b.title)==null?void 0:v.length)>40?`${(y=e.volumeInfo)==null?void 0:y.title.substring(0,40)}...`:(N=e.volumeInfo)==null?void 0:N.title}),n("span",{className:"book-card_contents__categories",children:(_=e.volumeInfo)==null?void 0:_.categories}),n("span",{className:"book-card_contents__authors",children:(A=(k=e.volumeInfo)==null?void 0:k.authors)==null?void 0:A.join(", ")})]}),n("div",{children:o?(S=e.volumeInfo)==null?void 0:S.description:null})]})},e.id)},ne=()=>{const e=j(),[o,t,i]=q(a=>[a.books,a.loading,a]),r=H("/books/:id"),s=r?o.find(a=>a.id===r.params.id):null;return c("div",{className:"container",children:[n(oe,{dispatch:e,state:i}),c(M,{children:[n(R,{path:"/books/:id",element:n(C,{book:s,page:!0})}),n(R,{path:"/books",element:t?n("h3",{className:"loading screen",children:"Loading... Please wait."}):n(re,{books:o,dispatch:e,state:i})})]})]})},te=P(J,$());K.render(n(Y,{children:n(W,{store:te,children:n(ne,{})})}),document.getElementById("root"));
